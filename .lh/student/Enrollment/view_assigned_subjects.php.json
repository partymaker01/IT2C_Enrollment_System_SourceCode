{
    "sourceFile": "student/Enrollment/view_assigned_subjects.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1748594591840,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1748594591840,
            "name": "Commit-0",
            "content": "<?php\r\nsession_start();\r\n\r\n// Database connection info\r\n$host = \"localhost\";\r\n$dbname = \"enrollment_system\";\r\n$username = \"root\";\r\n$password = \"\";\r\n\r\n// Create connection using PDO\r\ntry {\r\n    $pdo = new PDO(\"mysql:host=$host;dbname=$dbname;charset=utf8\", $username, $password);\r\n    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\r\n} catch (PDOException $e) {\r\n    die(\"Database connection failed: \" . $e->getMessage());\r\n}\r\n\r\n// Ensure student is logged in\r\nif (!isset($_SESSION['student_number'])) {\r\n    die(\"Unauthorized access.\");\r\n}\r\n\r\n$student_number = $_SESSION['student_number'];\r\n\r\n// Fetch student by student_number\r\n$stmtStudent = $pdo->prepare(\"SELECT * FROM students WHERE student_number = :student_number LIMIT 1\");\r\n$stmtStudent->execute(['student_number' => $student_number]);\r\n$student = $stmtStudent->fetch(PDO::FETCH_ASSOC);\r\n\r\nif (!$student) {\r\n    die(\"Student not found.\");\r\n}\r\n\r\n// Get semester and school year from GET or use defaults\r\n$semester = $_GET['semester'] ?? '1st Semester';\r\n$school_year = $_GET['school_year'] ?? '2024-2025';\r\n\r\n// Fetch assigned subjects\r\n$sqlSubjects = \"SELECT s.subject_code, s.subject_title, s.instructor, s.day, s.time, s.room, s.units\r\n                FROM subjects s\r\n                JOIN student_subjects ss ON s.id = ss.subject_id\r\n                WHERE ss.student_id = :student_id\r\n                AND ss.semester = :semester\r\n                AND ss.school_year = :school_year\r\n                ORDER BY s.subject_code\";\r\n\r\n$stmtSubjects = $pdo->prepare($sqlSubjects);\r\n$stmtSubjects->execute([\r\n    'student_id' => $student['id'],\r\n    'semester' => $semester,\r\n    'school_year' => $school_year\r\n]);\r\n$subjects = $stmtSubjects->fetchAll(PDO::FETCH_ASSOC);\r\n?>\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\" />\r\n  <title>Assigned Subjects</title>\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n  <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n  <link rel=\"icon\" href=\"favicon.ico\" type=\"image/x-icon\">\r\n  <style>\r\n    body {\r\n      background-color: #f0fdf4;\r\n      font-family: 'Segoe UI', sans-serif;\r\n    }\r\n    .navbar {\r\n      background-color: #2e7d32;\r\n    }\r\n    .navbar-brand, .nav-link {\r\n      color: #fff !important;\r\n      font-weight: 600;\r\n      letter-spacing: 0.05em;\r\n    }\r\n    .nav-link:hover {\r\n      color: #c8e6c9 !important;\r\n    }\r\n    h2 {\r\n      color: #2e7d32;\r\n      font-weight: bold;\r\n    }\r\n    .table thead {\r\n      background-color: #43a047;\r\n      color: white;\r\n    }\r\n    .btn-outline-success {\r\n      border-radius: 50px;\r\n    }\r\n    @media print {\r\n      .no-print {\r\n        display: none;\r\n      }\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  <nav class=\"navbar navbar-expand-lg\">\r\n    <div class=\"container\">\r\n      <a class=\"navbar-brand\" href=\"/IT2C_Enrollment_System_SourceCode/student//student-dashboard.php\">\r\n        Student Dashboard\r\n      </a>\r\n      <button\r\n        class=\"navbar-toggler\"\r\n        type=\"button\"\r\n        data-bs-toggle=\"collapse\"\r\n        data-bs-target=\"#navbarNav\"\r\n        aria-controls=\"navbarNav\"\r\n        aria-expanded=\"false\"\r\n        aria-label=\"Toggle navigation\"\r\n      >\r\n        <span class=\"navbar-toggler-icon\"></span>\r\n      </button>\r\n      <div class=\"collapse navbar-collapse\" id=\"navbarNav\">\r\n        <ul class=\"navbar-nav ms-auto\">\r\n          <li class=\"nav-item\">\r\n            <a\r\n              class=\"nav-link\"\r\n              href=\"/IT2C_Enrollment_System_SourceCode/student//student-dashboard.php\"\r\n              class=\"btn btn-outline-secondary mb-3\"\r\n            >\r\n              <i class=\"bi bi-arrow-left\"></i> Back to Dashboard\r\n            </a>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </nav>\r\n\r\n  <div class=\"container mt-5\">\r\n    <h2 class=\"mb-4\">Assigned Subjects<?= htmlspecialchars($student['student_name']) ?></h2>\r\n    <p><strong>Program:</strong> <?= htmlspecialchars($student['program'] ?? 'N/A') ?></p>\r\n    <p><strong>Year Level:</strong> <?= htmlspecialchars($student['year_level'] ?? 'N/A') ?></p>\r\n    <p><strong>Section:</strong> <?= htmlspecialchars($student['section'] ?? 'N/A') ?></p>\r\n\r\n    <form method=\"GET\" class=\"row g-3 mb-4 no-print\">\r\n      <div class=\"col-md-4\">\r\n        <label for=\"semester\" class=\"form-label\">Semester</label>\r\n        <select class=\"form-select\" id=\"semester\" name=\"semester\">\r\n          <option <?= $semester == '1st Semester' ? 'selected' : '' ?>>1st Semester</option>\r\n          <option <?= $semester == '2nd Semester' ? 'selected' : '' ?>>2nd Semester</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-md-4\">\r\n        <label for=\"school_year\" class=\"form-label\">School Year</label>\r\n        <input\r\n          type=\"text\"\r\n          class=\"form-control\"\r\n          id=\"school_year\"\r\n          name=\"school_year\"\r\n          value=\"<?= htmlspecialchars($school_year) ?>\"\r\n        />\r\n      </div>\r\n      <div class=\"col-md-4 align-self-end\">\r\n        <button type=\"submit\" class=\"btn btn-success w-100\">Load Subjects</button>\r\n      </div>\r\n    </form>\r\n\r\n    <div class=\"table-responsive\">\r\n      <table class=\"table table-bordered table-hover align-middle\">\r\n        <thead>\r\n          <tr>\r\n            <th>Subject Code</th>\r\n            <th>Subject Title</th>\r\n            <th>Instructor</th>\r\n            <th>Day</th>\r\n            <th>Time</th>\r\n            <th>Room</th>\r\n            <th>Units</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <?php if (count($subjects) > 0): ?>\r\n            <?php foreach ($subjects as $subject): ?>\r\n              <tr>\r\n                <td><?= htmlspecialchars($subject['subject_code']) ?></td>\r\n                <td><?= htmlspecialchars($subject['subject_title']) ?></td>\r\n                <td><?= htmlspecialchars($subject['instructor']) ?></td>\r\n                <td><?= htmlspecialchars($subject['day']) ?></td>\r\n                <td><?= htmlspecialchars($subject['time']) ?></td>\r\n                <td><?= htmlspecialchars($subject['room']) ?></td>\r\n                <td><?= htmlspecialchars($subject['units']) ?></td>\r\n              </tr>\r\n            <?php endforeach; ?>\r\n          <?php else: ?>\r\n            <tr><td colspan=\"7\" class=\"text-center\">No subjects found for this semester and school year.</td></tr>\r\n          <?php endif; ?>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n\r\n    <div class=\"d-flex justify-content-end gap-2 mt-3 no-print\">\r\n      <button class=\"btn btn-outline-success\" onclick=\"window.print()\">\r\n        <i class=\"bi bi-printer\"></i> Print Schedule\r\n      </button>\r\n    </div>\r\n  </div>\r\n</body>\r\n</html>"
        }
    ]
}