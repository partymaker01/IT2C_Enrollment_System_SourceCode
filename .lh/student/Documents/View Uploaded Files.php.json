{
    "sourceFile": "student/Documents/View Uploaded Files.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1748594694803,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1748594694803,
            "name": "Commit-0",
            "content": "<?php\r\n// Database connection parameters - replace with your actual credentials\r\n$host = 'localhost';\r\n$dbname = 'enrollment_system';\r\n$user = 'root';\r\n$pass = '';\r\n\r\ntry {\r\n    $pdo = new PDO(\"mysql:host=$host;dbname=$dbname;charset=utf8mb4\", $user, $pass, [\r\n        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION\r\n    ]);\r\n} catch (PDOException $e) {\r\n    die(\"Database connection failed: \" . $e->getMessage());\r\n}\r\n\r\n// Assuming student_id is known, e.g., from session or request\r\n$student_id = 1; // Change this dynamically according to logged-in user\r\n\r\n// Fetch uploaded documents for this student\r\n$stmt = $pdo->prepare(\"SELECT * FROM uploaded_documents WHERE student_id = ? ORDER BY upload_date DESC\");\r\n$stmt->execute([$student_id]);\r\n$uploadedFiles = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n\r\n// Function to return badge class by status\r\nfunction badgeClass($status) {\r\n    return match (strtolower($status)) {\r\n        'uploaded' => 'bg-primary',\r\n        'verified' => 'bg-success',\r\n        'rejected' => 'bg-danger',\r\n        'pending' => 'bg-warning text-dark',\r\n        default => 'bg-secondary',\r\n    };\r\n}\r\n?>\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n<meta charset=\"UTF-8\" />\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n<title>View Uploaded Files</title>\r\n<link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n<link rel=\"icon\" href=\"favicon.ico\" type=\"image/x-icon\">\r\n<style>\r\n  body { background-color: #e8f5e9; }\r\n  tbody tr:hover {\r\n    background-color: #d0f0d6;\r\n  }\r\n  .navbar {\r\n      background-color: #2e7d32;\r\n    }\r\n  .navbar-brand, .nav-link {\r\n      color: #fff !important;\r\n      font-weight: 600;\r\n      letter-spacing: 0.05em;\r\n    }\r\n  .nav-link:hover {\r\n      color: #c8e6c9 !important;\r\n    }\r\n  .btn-reupload:disabled {\r\n    opacity: 0.6;\r\n    cursor: not-allowed;\r\n  }\r\n</style>\r\n</head>\r\n<body>\r\n  <nav class=\"navbar navbar-expand-lg\">\r\n    <div class=\"container\">\r\n      <a class=\"navbar-brand\" href=\"/IT2C_Enrollment_System_SourceCode/student//student-dashboard.php\">\r\n        Student Dashboard\r\n      </a>\r\n      <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarNav\" \r\n        aria-controls=\"navbarNav\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\r\n        <span class=\"navbar-toggler-icon\"></span>\r\n      </button>\r\n      <div class=\"collapse navbar-collapse\" id=\"navbarNav\">\r\n        <ul class=\"navbar-nav ms-auto\">\r\n          <li class=\"nav-item\"><a class=\"nav-link\" href=\"/IT2C_Enrollment_System_SourceCode/student//student-dashboard.php\" class=\"btn btn-outline-secondary mb-3\">\r\n          <i class=\"bi bi-arrow-left\"></i> Back to Dashboard\r\n          </a></li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </nav>\r\n  <div class=\"container my-5\">\r\n    <h2 class=\"text-success mb-4\">\r\n      View Uploaded Files\r\n    </h2>\r\n    <div class=\"table-responsive shadow-sm bg-white rounded\">\r\n      <table class=\"table table-striped align-middle mb-0\">\r\n        <thead class=\"table-success\">\r\n          <tr>\r\n            <th>Document Type</th>\r\n            <th>File Name</th>\r\n            <th>Upload Date</th>\r\n            <th>Status</th>\r\n            <th>Remarks</th>\r\n            <th style=\"width: 140px;\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <?php if ($uploadedFiles): ?>\r\n            <?php foreach ($uploadedFiles as $file): ?>\r\n              <tr>\r\n                <td><?= htmlspecialchars($file['doc_type']) ?></td>\r\n                <td><?= htmlspecialchars($file['file_name']) ?></td>\r\n                <td><?= date('M d, Y', strtotime($file['upload_date'])) ?></td>\r\n                <td>\r\n                  <span class=\"badge <?= badgeClass($file['status']) ?>\">\r\n                    <?= htmlspecialchars($file['status']) ?>\r\n                  </span>\r\n                </td>\r\n                <td><?= htmlspecialchars($file['remarks']) ?></td>\r\n                <td>\r\n                  <a href=\"<?= htmlspecialchars($file['view_link']) ?>\" target=\"_blank\" class=\"btn btn-sm btn-outline-secondary me-1\" aria-label=\"View <?= htmlspecialchars($file['doc_type']) ?>\">View</a>\r\n                  <?php if ($file['can_reupload']): ?>\r\n                    <a href=\"#\" class=\"btn btn-sm btn-outline-primary btn-reupload\" aria-label=\"Re-upload <?= htmlspecialchars($file['doc_type']) ?>\">Re-upload</a>\r\n                  <?php else: ?>\r\n                    <button class=\"btn btn-sm btn-outline-primary btn-reupload\" disabled aria-label=\"Re-upload <?= htmlspecialchars($file['doc_type']) ?>\">Re-upload</button>\r\n                  <?php endif; ?>\r\n                </td>\r\n              </tr>\r\n            <?php endforeach; ?>\r\n          <?php else: ?>\r\n            <tr>\r\n              <td colspan=\"6\" class=\"text-center\">No uploaded documents found.</td>\r\n            </tr>\r\n          <?php endif; ?>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n\r\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js\"></script>\r\n</body>\r\n</html>"
        }
    ]
}