{
    "sourceFile": "ADMIN/Student_Management/view-all-students.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1748651981476,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1748651981476,
            "name": "Commit-0",
            "content": "<?php\r\n// database config - change these to your own MySQL credentials\r\n$host = 'localhost';\r\n$db   = 'enrollment_system';\r\n$user = 'root';\r\n$pass = '';\r\n\r\n// create mysqli connection\r\n$conn = new mysqli($host, $user, $pass, $db);\r\n\r\n// check connection\r\nif ($conn->connect_error) {\r\n    die(\"Connection failed: \" . $conn->connect_error);\r\n}\r\n\r\n// fetch all students from database\r\n$sql = \"SELECT * FROM students ORDER BY id ASC\";\r\n$result = $conn->query($sql);\r\n\r\n$students = [];\r\nif ($result && $result->num_rows > 0) {\r\n    while($row = $result->fetch_assoc()) {\r\n        $students[] = $row;\r\n    }\r\n}\r\n\r\n// close connection\r\n$conn->close();\r\n?>\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\" />\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n  <title>View All Students - Enrollment System</title>\r\n  <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n  <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js\"></script>\r\n  <link rel=\"icon\" href=\"favicon.ico\" type=\"image/x-icon\">\r\n  <style>\r\n    body {\r\n      background-color: #e6f2e6;\r\n    }\r\n    .navbar {\r\n      background-color: #2e7d32;\r\n    }\r\n    .navbar-brand, .nav-link {\r\n      color: #fff !important;\r\n      font-weight: 600;\r\n      letter-spacing: 0.05em;\r\n    }\r\n    .nav-link:hover {\r\n      color: #c8e6c9 !important;\r\n    }\r\n    .school-logo {\r\n      width: 50px;\r\n      height: 50px;\r\n      object-fit: cover;\r\n      border-radius: 50%;\r\n      margin-right: 10px;\r\n      border: 2px solid #fff;\r\n    }\r\n    .table thead {\r\n      background-color: #2e7d32;\r\n      color: white;\r\n      position: sticky;\r\n      top: 0;\r\n      z-index: 10;\r\n    }\r\n    .search-bar {\r\n      max-width: 350px;\r\n    }\r\n    .btn-sm {\r\n      min-width: 60px;\r\n    }\r\n    @media (max-width: 576px) {\r\n      .d-flex.justify-content-between.mb-3 {\r\n        flex-direction: column;\r\n        gap: 10px;\r\n      }\r\n      .search-bar {\r\n        max-width: 100%;\r\n      }\r\n      .btn-success {\r\n        width: 100%;\r\n      }\r\n      table.table thead tr th, \r\n      table.table tbody tr td {\r\n        font-size: 14px;\r\n      }\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  <nav class=\"navbar navbar-expand-lg navbar-dark bg-success py-3\">\r\n  <div class=\"container-fluid\">\r\n    <a class=\"navbar-brand d-flex align-items-center\" href=\"#\">\r\n      <img src=\"/IT2C_Enrollment_System_SourceCode/picture/tlgc_pic.jpg\" alt=\"School Logo\" class=\"school-logo\">\r\n      Admin Panel\r\n    </a>\r\n    <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarNav\" aria-controls=\"navbarNav\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\r\n      <span class=\"navbar-toggler-icon\"></span>\r\n      </button>\r\n      <div class=\"collapse navbar-collapse\" id=\"navbarNav\">\r\n        <ul class=\"navbar-nav ms-auto\">\r\n          <li class=\"nav-item\"><a class=\"nav-link\" href=\"/IT2C_Enrollment_System_SourceCode/ADMIN/admin-dashboard.php\" class=\"btn btn-outline-secondary mb-3\">\r\n          <i class=\"bi bi-arrow-left\"></i> Back to Dashboard\r\n          </a>\r\n      </ul>\r\n      </div>\r\n    </div>\r\n  </nav> \r\n  <div class=\"container my-5\">\r\n    <h2 class=\"text-center mb-4 text-success\">\r\n      View All Students\r\n    </h2>\r\n\r\n    <div class=\"d-flex justify-content-between mb-3 align-items-center flex-wrap gap-2\">\r\n      <div class=\"input-group search-bar\">\r\n          <span class=\"input-group-text\" id=\"search-icon\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-search\" viewBox=\"0 0 16 16\">\r\n              <path d=\"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85zm-5.442 1.06a5 5 0 1 1 0-7.071 5 5 0 0 1 0 7.07z\"/>\r\n            </svg>\r\n          </span>\r\n          <input type=\"search\" id=\"searchInput\" class=\"form-control\" placeholder=\"Search students...\" aria-label=\"Search students\" aria-describedby=\"search-icon\" onkeyup=\"searchTable()\" />\r\n        </div>\r\n        <div class=\"d-flex gap-2\">\r\n          <a href=\"/IT2C_Enrollment_System_SourceCode/ADMIN/Student_Management/add-new-student.php\" class=\"btn btn-success\">\r\n            Add New Student\r\n          </a>\r\n        </div>\r\n      </div>\r\n    <div class=\"table-responsive shadow-sm rounded\">\r\n      <table class=\"table table-bordered table-hover align-middle mb-0\" id=\"studentsTable\" aria-describedby=\"studentTableDesc\">\r\n        <caption id=\"studentTableDesc\" class=\"visually-hidden\">\r\n          List of all students in the enrollment system\r\n        </caption>\r\n        <thead>\r\n          <tr>\r\n            <th scope=\"col\">\r\n              Student ID\r\n            </th>\r\n            <th scope=\"col\">\r\n              Full Name\r\n            </th>\r\n            <th scope=\"col\">\r\n              Program\r\n            </th>\r\n            <th scope=\"col\">\r\n              Year Level\r\n            </th>\r\n            <th scope=\"col\">\r\n              Contact Number\r\n            </th>\r\n            <th scope=\"col\" class=\"text-center\">\r\n              Actions\r\n            </th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <?php if (!empty($students)): ?>\r\n            <?php foreach ($students as $student): ?>\r\n            <tr>\r\n              <td><?= htmlspecialchars($student['id']) ?></td>\r\n              <td><?= htmlspecialchars($student['fullname']) ?></td>\r\n              <td><?= htmlspecialchars($student['program']) ?></td>\r\n              <td><?= htmlspecialchars($student['year_level']) ?></td>\r\n              <td><?= htmlspecialchars($student['contact']) ?></td>\r\n              <td class=\"text-center\">\r\n                <a href=\"view-student-details.php?id=<?= urlencode($student['id']) ?>\" class=\"btn btn-primary btn-sm me-1\" title=\"View details\">\r\n                  <i class=\"bi bi-eye\"></i> View\r\n                </a>\r\n                <a href=\"edit-student.php?id=<?= urlencode($student['id']) ?>\" class=\"btn btn-warning btn-sm me-1\" title=\"Edit student\">\r\n                  <i class=\"bi bi-pencil-square\"></i>\r\n                  Edit\r\n                </a>\r\n                <button class=\"btn btn-danger btn-sm\" title=\"Delete student\" data-bs-toggle=\"modal\" data-bs-target=\"#deleteModal\" data-student-id=\"<?= htmlspecialchars($student['id']) ?>\">\r\n                  <i class=\"bi bi-trash\"></i>\r\n                  Delete\r\n                </button>\r\n              </td>\r\n            </tr>\r\n            <?php endforeach; ?>\r\n          <?php else: ?>\r\n            <tr>\r\n              <td colspan=\"6\" class=\"text-center\">No students found.</td>\r\n            </tr>\r\n          <?php endif; ?>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Delete Confirmation Modal -->\r\n  <div class=\"modal fade\" id=\"deleteModal\" tabindex=\"-1\" aria-labelledby=\"deleteModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog modal-dialog-centered\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header bg-danger text-white\">\r\n          <h5 class=\"modal-title\" id=\"deleteModalLabel\">Confirm Delete</h5>\r\n          <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          Are you sure you want to delete student\r\n          <strong id=\"studentToDelete\"></strong>\r\n          ?\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\r\n          <button type=\"button\" class=\"btn btn-danger\" id=\"confirmDeleteBtn\">Delete</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css\">\r\n\r\n  <script>\r\n    function searchTable() {\r\n      const input = document.getElementById('searchInput').value.toLowerCase();\r\n      const table = document.getElementById('studentsTable');\r\n      const trs = table.tBodies[0].getElementsByTagName('tr');\r\n\r\n      for (let row of trs) {\r\n        let text = row.textContent.toLowerCase();\r\n        row.style.display = text.includes(input) ? '' : 'none';\r\n      }\r\n    }\r\n\r\n    // Delete modal handling\r\n    var deleteModal = document.getElementById('deleteModal');\r\n    var studentToDeleteSpan = document.getElementById('studentToDelete');\r\n    var confirmDeleteBtn = document.getElementById('confirmDeleteBtn');\r\n    var studentIdToDelete = null;\r\n\r\n    deleteModal.addEventListener('show.bs.modal', function(event) {\r\n      var button = event.relatedTarget;\r\n      studentIdToDelete = button.getAttribute('data-student-id');\r\n      var row = button.closest('tr');\r\n      var studentName = row.querySelector('td:nth-child(2)').textContent;\r\n      studentToDeleteSpan.textContent = studentName;\r\n    });\r\n\r\n    confirmDeleteBtn.addEventListener('click', function() {\r\n      if(studentIdToDelete){\r\n        // Redirect to a delete handler PHP script with student ID as a GET parameter\r\n        window.location.href = 'delete-student.php?id=' + encodeURIComponent(studentIdToDelete);\r\n      }\r\n    });\r\n  </script>\r\n</body>\r\n</html>\r\n"
        }
    ]
}