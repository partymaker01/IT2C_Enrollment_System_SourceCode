{
    "sourceFile": "ADMIN/helpdeskAdminProfileSettings/HelpDesk.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1749402269651,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1749402406754,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -286,4 +286,161 @@\n     <div class=\"modal fade\" id=\"ticketModal\" tabindex=\"-1\" aria-labelledby=\"ticketModalLabel\" aria-hidden=\"true\">\n         <div class=\"modal-dialog modal-lg modal-dialog-scrollable\">\n             <div class=\"modal-content\">\n                 <div class=\"modal-header bg-success text-white\">\n+                    <h5 class=\"modal-title\" id=\"ticketModalLabel\">Ticket Details</h5>\n+                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n+                </div>\n+                <div class=\"modal-body\n+                    <div class=\"row mb-3\">\n+                        <div class=\"col-md-6\">\n+                            <strong>Ticket ID:</strong> <span id=\"modalTicketID\"></span>\n+                        </div>\n+                        <div class=\"col-md-6\">\n+                            <strong>Student Name:</strong> <span id=\"modalStudentName\"></span>\n+                        </div>\n+                    </div>\n+                    <div class=\"row mb-3\">\n+                        <div class=\"col-md-6\">\n+                            <strong>Category:</strong> <span id=\"modalCategory\"></span>\n+                        </div>\n+                        <div class=\"col-md-6\">\n+                            <strong>Priority:</strong> \n+                            <span id=\"modalPriority\" class=\"badge\"></span>\n+                        </div>\n+                    </div>\n+                    <div class=\"row mb-3\">\n+                        <div class=\"col-md-6\">\n+                            <strong>Status:</strong> \n+                            <span id=\"modalStatus\" class=\"badge\"></span>\n+                        </div>\n+                        <div class=\"col-md-6\">\n+                            <strong>Date Submitted:</strong> \n+                            <span id=\"modalDateSubmitted\"></span>\n+                        </div>\n+                    </div>\n+                    <hr />\n+                    <h5>Message</h5>\n+                    <p id=\"modalMessage\"></p>\n+\n+                    <hr />\n+                    <h5>Conversation Thread</h5>\n+                    <div id=\"conversationThread\" style=\"max-height: 300px; overflow-y: auto;\">\n+                        <!-- Conversation messages will be injected here -->\n+                    </div>\n+\n+                    <hr />\n+                    <h5>Reply to Ticket</h5>\n+                    <div class=\"mb-3\">\n+                        <textarea class=\"form-control\" id=\"replyMessage\" rows=\"3\" placeholder=\"Type your reply here...\"></textarea>\n+                    </div>\n+                    <div class=\"d-flex justify-content-end\">\n+                        <button class=\"btn btn-success\" id=\"sendReplyButton\" onclick=\"sendReply()\" aria-label=\"Send reply to ticket\">\n+                            <i class=\"bi bi-send me-1\"></i> Send Reply\n+                        </button>\n+                    </div>\n+                </div>\n+                <div class=\"modal-footer\">\n+                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\n+                    <button type=\"button\" class=\"btn btn-danger\" id=\"closeTicketButton\" onclick=\"closeTicket()\"\n+                        aria-label=\"Close this ticket\">Close Ticket</button>\n+                </div>\n+            </div>\n+        </div>\n+    </div>          \n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js\"></script>\n+    <script>\n+        // Function to open ticket details in modal\n+        function openTicketDetails(ticketID, studentName, category, priority, priorityClass, status, statusClass, dateSubmitted, message, conversationHTML) {\n+            document.getElementById('modalTicketID').textContent = ticketID;\n+            document.getElementById('modalStudentName').textContent = studentName;\n+            document.getElementById('modalCategory').textContent = category;\n+            document.getElementById('modalPriority').textContent = priority;\n+            document.getElementById('modalPriority').className = 'badge ' + priorityClass;\n+            document.getElementById('modalStatus').textContent = status;\n+            document.getElementById('modalStatus').className = 'badge ' + statusClass;\n+            document.getElementById('modalDateSubmitted').textContent = dateSubmitted;\n+            document.getElementById('modalMessage').textContent = message;\n+            document.getElementById('conversationThread').innerHTML = conversationHTML;\n+\n+            // Clear reply textarea\n+            document.getElementById('replyMessage').value = '';\n+        }\n+\n+        // Function to send reply\n+        function sendReply() {\n+            const replyMessage = document.getElementById('replyMessage').value.trim();\n+            if (!replyMessage) {\n+                alert(\"Please enter a reply message.\");\n+                return;\n+            }\n+\n+            // Here you would typically send the reply to the server via AJAX\n+            // For this example, we'll just append it to the conversation thread\n+            const ticketID = document.getElementById('modalTicketID').textContent;\n+            const newMessageHTML = `<p><strong>You:</strong> ${replyMessage}</p>`;\n+            const conversationThread = document.getElementById('conversationThread');\n+            conversationThread.innerHTML += newMessageHTML;\n+\n+            // Clear the reply textarea\n+            document.getElementById('replyMessage').value = '';\n+        }\n+\n+        // Function to close ticket\n+        function closeTicket() {\n+            const ticketID = document.getElementById('modalTicketID').textContent;\n+            if (confirm(`Are you sure you want to close ticket ${ticketID}?`)) {\n+                // Here you would typically send a request to the server to close the ticket\n+                alert(`Ticket ${ticketID} has been closed.`);\n+                // Close the modal\n+                const modal = bootstrap.Modal.getInstance(document.getElementById('\n+ticketModal'));\n+                modal.hide();\n+\n+                // Optionally, you could also remove the ticket from the table\n+                const row = document.querySelector(`tr:has(td:contains('${ticketID}'))`);\n+                if (row) {\n+                    row.remove();\n+                }\n+            }\n+        }\n+\n+        // Function to reset filters\n+        function resetFilters() {\n+            document.getElementById('filterStatus').value = '';\n+            document.getElementById('searchInput').value = '';\n+            // Optionally, you could reload the page or re-fetch tickets\n+            location.reload();\n+        }\n+\n+        // Filter tickets by status\n+        document.getElementById('filterStatus').addEventListener('change', function() {\n+            const status = this.value.toLowerCase();\n+            const rows = document.querySelectorAll('#ticketsTable tbody tr');\n+            rows.forEach(row => {\n+                const badge = row.querySelector('.badge');\n+                if (status === '' || badge.textContent.toLowerCase() === status) {\n+                    row.style.display = '';\n+                } else {\n+                    row.style.display = 'none';\n+                }\n+            });\n+        });\n+\n+        // Search tickets by student name or ticket ID\n+        document.getElementById('searchInput').addEventListener('input', function() {\n+            const searchTerm = this.value.toLowerCase();\n+            const rows = document.querySelectorAll('#ticketsTable tbody tr');\n+            rows.forEach(row => {\n+                const studentName = row.cells[1].textContent.toLowerCase();\n+                const ticketID = row.cells[0].textContent.toLowerCase();\n+                if (studentName.includes(searchTerm) || ticketID.includes(searchTerm)) {\n+                    row.style.display = '';\n+                } else {\n+                    row.style.display = 'none';\n+                }\n+            });\n+        });\n+    </script>\n+</body>\n+</html>\n+<?php                                 \n\\ No newline at end of file\n"
                },
                {
                    "date": 1749402559464,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-<?php\n+<!-- <?php\n session_start();\n \n // Check if logged in\n if (!isset($_SESSION['admin_logged_in']) || $_SESSION['admin_logged_in'] !== true) {\n@@ -289,158 +289,5 @@\n                 <div class=\"modal-header bg-success text-white\">\n                     <h5 class=\"modal-title\" id=\"ticketModalLabel\">Ticket Details</h5>\n                     <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                 </div>\n-                <div class=\"modal-body\n-                    <div class=\"row mb-3\">\n-                        <div class=\"col-md-6\">\n-                            <strong>Ticket ID:</strong> <span id=\"modalTicketID\"></span>\n-                        </div>\n-                        <div class=\"col-md-6\">\n-                            <strong>Student Name:</strong> <span id=\"modalStudentName\"></span>\n-                        </div>\n-                    </div>\n-                    <div class=\"row mb-3\">\n-                        <div class=\"col-md-6\">\n-                            <strong>Category:</strong> <span id=\"modalCategory\"></span>\n-                        </div>\n-                        <div class=\"col-md-6\">\n-                            <strong>Priority:</strong> \n-                            <span id=\"modalPriority\" class=\"badge\"></span>\n-                        </div>\n-                    </div>\n-                    <div class=\"row mb-3\">\n-                        <div class=\"col-md-6\">\n-                            <strong>Status:</strong> \n-                            <span id=\"modalStatus\" class=\"badge\"></span>\n-                        </div>\n-                        <div class=\"col-md-6\">\n-                            <strong>Date Submitted:</strong> \n-                            <span id=\"modalDateSubmitted\"></span>\n-                        </div>\n-                    </div>\n-                    <hr />\n-                    <h5>Message</h5>\n-                    <p id=\"modalMessage\"></p>\n-\n-                    <hr />\n-                    <h5>Conversation Thread</h5>\n-                    <div id=\"conversationThread\" style=\"max-height: 300px; overflow-y: auto;\">\n-                        <!-- Conversation messages will be injected here -->\n-                    </div>\n-\n-                    <hr />\n-                    <h5>Reply to Ticket</h5>\n-                    <div class=\"mb-3\">\n-                        <textarea class=\"form-control\" id=\"replyMessage\" rows=\"3\" placeholder=\"Type your reply here...\"></textarea>\n-                    </div>\n-                    <div class=\"d-flex justify-content-end\">\n-                        <button class=\"btn btn-success\" id=\"sendReplyButton\" onclick=\"sendReply()\" aria-label=\"Send reply to ticket\">\n-                            <i class=\"bi bi-send me-1\"></i> Send Reply\n-                        </button>\n-                    </div>\n-                </div>\n-                <div class=\"modal-footer\">\n-                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\n-                    <button type=\"button\" class=\"btn btn-danger\" id=\"closeTicketButton\" onclick=\"closeTicket()\"\n-                        aria-label=\"Close this ticket\">Close Ticket</button>\n-                </div>\n-            </div>\n-        </div>\n-    </div>          \n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js\"></script>\n-    <script>\n-        // Function to open ticket details in modal\n-        function openTicketDetails(ticketID, studentName, category, priority, priorityClass, status, statusClass, dateSubmitted, message, conversationHTML) {\n-            document.getElementById('modalTicketID').textContent = ticketID;\n-            document.getElementById('modalStudentName').textContent = studentName;\n-            document.getElementById('modalCategory').textContent = category;\n-            document.getElementById('modalPriority').textContent = priority;\n-            document.getElementById('modalPriority').className = 'badge ' + priorityClass;\n-            document.getElementById('modalStatus').textContent = status;\n-            document.getElementById('modalStatus').className = 'badge ' + statusClass;\n-            document.getElementById('modalDateSubmitted').textContent = dateSubmitted;\n-            document.getElementById('modalMessage').textContent = message;\n-            document.getElementById('conversationThread').innerHTML = conversationHTML;\n-\n-            // Clear reply textarea\n-            document.getElementById('replyMessage').value = '';\n-        }\n-\n-        // Function to send reply\n-        function sendReply() {\n-            const replyMessage = document.getElementById('replyMessage').value.trim();\n-            if (!replyMessage) {\n-                alert(\"Please enter a reply message.\");\n-                return;\n-            }\n-\n-            // Here you would typically send the reply to the server via AJAX\n-            // For this example, we'll just append it to the conversation thread\n-            const ticketID = document.getElementById('modalTicketID').textContent;\n-            const newMessageHTML = `<p><strong>You:</strong> ${replyMessage}</p>`;\n-            const conversationThread = document.getElementById('conversationThread');\n-            conversationThread.innerHTML += newMessageHTML;\n-\n-            // Clear the reply textarea\n-            document.getElementById('replyMessage').value = '';\n-        }\n-\n-        // Function to close ticket\n-        function closeTicket() {\n-            const ticketID = document.getElementById('modalTicketID').textContent;\n-            if (confirm(`Are you sure you want to close ticket ${ticketID}?`)) {\n-                // Here you would typically send a request to the server to close the ticket\n-                alert(`Ticket ${ticketID} has been closed.`);\n-                // Close the modal\n-                const modal = bootstrap.Modal.getInstance(document.getElementById('\n-ticketModal'));\n-                modal.hide();\n-\n-                // Optionally, you could also remove the ticket from the table\n-                const row = document.querySelector(`tr:has(td:contains('${ticketID}'))`);\n-                if (row) {\n-                    row.remove();\n-                }\n-            }\n-        }\n-\n-        // Function to reset filters\n-        function resetFilters() {\n-            document.getElementById('filterStatus').value = '';\n-            document.getElementById('searchInput').value = '';\n-            // Optionally, you could reload the page or re-fetch tickets\n-            location.reload();\n-        }\n-\n-        // Filter tickets by status\n-        document.getElementById('filterStatus').addEventListener('change', function() {\n-            const status = this.value.toLowerCase();\n-            const rows = document.querySelectorAll('#ticketsTable tbody tr');\n-            rows.forEach(row => {\n-                const badge = row.querySelector('.badge');\n-                if (status === '' || badge.textContent.toLowerCase() === status) {\n-                    row.style.display = '';\n-                } else {\n-                    row.style.display = 'none';\n-                }\n-            });\n-        });\n-\n-        // Search tickets by student name or ticket ID\n-        document.getElementById('searchInput').addEventListener('input', function() {\n-            const searchTerm = this.value.toLowerCase();\n-            const rows = document.querySelectorAll('#ticketsTable tbody tr');\n-            rows.forEach(row => {\n-                const studentName = row.cells[1].textContent.toLowerCase();\n-                const ticketID = row.cells[0].textContent.toLowerCase();\n-                if (studentName.includes(searchTerm) || ticketID.includes(searchTerm)) {\n-                    row.style.display = '';\n-                } else {\n-                    row.style.display = 'none';\n-                }\n-            });\n-        });\n-    </script>\n-</body>\n-</html>\n-<?php                                 \n\\ No newline at end of file\n+                <div class=\"modal-body                       -->\n\\ No newline at end of file\n"
                }
            ],
            "date": 1749402269651,
            "name": "Commit-0",
            "content": "<?php\nsession_start();\n\n// Check if logged in\nif (!isset($_SESSION['admin_logged_in']) || $_SESSION['admin_logged_in'] !== true) {\n    header(\"Location: ../../logregfor/admin-login.php\");\n    exit();\n}\n\ninclude '../../db.php';\n\n// Fetch tickets from database\ntry {\n    $stmt = $pdo->query(\"SELECT * FROM tickets ORDER BY date_submitted DESC\");\n    $tickets = $stmt->fetchAll();\n\n    // Fetch conversations grouped by ticket_id\n    $stmt2 = $pdo->query(\"SELECT * FROM conversations ORDER BY created_at ASC\");\n    $conversationsRaw = $stmt2->fetchAll();\n\n    $conversations = [];\n    foreach ($conversationsRaw as $conv) {\n        $conversations[$conv['ticket_id']][] = [\n            'sender' => $conv['sender'],\n            'message' => $conv['message']\n        ];\n    }\n} catch (PDOException $e) {\n    // If tables don't exist yet, use sample data\n    $tickets = [\n        [\n            'ticket_id' => 'HD-2025-001',\n            'student_name' => 'John Lester Lina',\n            'category' => 'Enrollment Issue',\n            'priority' => 'High',\n            'status' => 'Open',\n            'date_submitted' => '2025-05-20 10:15:00',\n            'message' => 'I am having trouble with my enrollment status. It shows pending but I already submitted all requirements.',\n        ],\n        [\n            'ticket_id' => 'HD-2025-002',\n            'student_name' => 'Maria Santos',\n            'category' => 'Document Request',\n            'priority' => 'Medium',\n            'status' => 'In Progress',\n            'date_submitted' => '2025-05-19 14:30:00',\n            'message' => 'I need to request my transcript of records for scholarship application.',\n        ],\n        [\n            'ticket_id' => 'HD-2025-003',\n            'student_name' => 'James Rodriguez',\n            'category' => 'Technical Issue',\n            'priority' => 'Low',\n            'status' => 'Resolved',\n            'date_submitted' => '2025-05-18 09:45:00',\n            'message' => 'I cannot access my student portal account. It says \"invalid credentials\".',\n        ]\n    ];\n    \n    $conversations = [];\n}\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n    <title>Help Desk - Admin Dashboard</title>\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css\" rel=\"stylesheet\" />\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css\" rel=\"stylesheet\">\n    <link rel=\"icon\" href=\"../../picture/tlgc_pic.jpg\" type=\"image/x-icon\">\n    <style>\n        :root {\n            --primary-green: #2e7d32;\n            --light-green: #e8f5e9;\n            --accent-green: #43a047;\n            --hover-green: #c8e6c9;\n            --dark-green: #1b5e20;\n        }\n        \n        body { \n            background-color: #f8f9fa; \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n        }\n        \n        .navbar {\n            background-color: var(--primary-green);\n        }\n        \n        .navbar-brand, .nav-link {\n            color: #fff !important;\n            font-weight: 600;\n            letter-spacing: 0.05em;\n        }\n        \n        .nav-link:hover {\n            color: var(--hover-green) !important;\n        }\n        \n        .school-logo {\n            width: 50px;\n            height: 50px;\n            object-fit: cover;\n            border-radius: 50%;\n            margin-right: 10px;\n            border: 2px solid #fff;\n        }\n        \n        .badge-open { background-color: #0d6efd; }\n        .badge-inprogress { background-color: #ffc107; color: #212529; }\n        .badge-resolved { background-color: #198754; }\n        .badge-closed { background-color: #6c757d; }\n        \n        thead th { \n            position: sticky; \n            top: 0; \n            background-color: #d1e7dd; \n            z-index: 10; \n        }\n        \n        button.btn { transition: background-color 0.3s ease; }\n        button.btn-primary:hover { background-color: #004085; }\n        button.btn-success:hover { background-color: #14532d; }\n        \n        .modal-header.bg-success { background-color: #198754 !important; }\n        \n        #conversationThread { \n            scrollbar-width: thin; \n            scrollbar-color: #198754 #e9ecef; \n        }\n        \n        #conversationThread::-webkit-scrollbar { width: 8px; }\n        #conversationThread::-webkit-scrollbar-thumb { \n            background-color: #198754; \n            border-radius: 4px; \n        }\n        \n        #replyStatus { min-width: 140px; }\n\n        @media (max-width: 575.98px) {\n            th:nth-child(3), td:nth-child(3),\n            th:nth-child(6), td:nth-child(6) {\n                display: none;\n            }\n\n            .badge {\n                font-size: 0.75rem;\n                padding: 0.3em 0.4em;\n            }\n\n            table {\n                font-size: 0.85rem;\n            }\n            \n            .modal-lg {\n                max-width: 95vw;\n                margin: 0 10px;\n            }\n            \n            .row.mb-3 > div {\n                margin-bottom: 1rem;\n            }\n            \n            #filterStatus, #searchInput, button.btn-success {\n                width: 100% !important;\n            }\n        }\n    </style>\n</head>\n<body>\n    <nav class=\"navbar navbar-expand-lg navbar-dark py-3\">\n        <div class=\"container-fluid\">\n            <a class=\"navbar-brand d-flex align-items-center\" href=\"../admin-dashboard.php\">\n                <img src=\"../../picture/tlgc_pic.jpg\" alt=\"School Logo\" class=\"school-logo\">\n                Admin Panel\n            </a>\n            <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarNav\">\n                <span class=\"navbar-toggler-icon\"></span>\n            </button>\n            <div class=\"collapse navbar-collapse\" id=\"navbarNav\">\n                <ul class=\"navbar-nav ms-auto\">\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"../admin-dashboard.php\">\n                            <i class=\"bi bi-arrow-left me-1\"></i> Back to Dashboard\n                        </a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n    \n    <div class=\"container my-4\">\n        <h2 class=\"mb-4 text-success\">\n            <i class=\"bi bi-headset me-2\"></i>Help Desk - Admin Dashboard\n        </h2>\n\n        <div class=\"row mb-3 g-3\">\n            <div class=\"col-md-3 col-12\">\n                <select class=\"form-select\" id=\"filterStatus\" aria-label=\"Filter tickets by status\">\n                    <option value=\"\">Filter by Status</option>\n                    <option value=\"Open\">Open</option>\n                    <option value=\"In Progress\">In Progress</option>\n                    <option value=\"Resolved\">Resolved</option>\n                    <option value=\"Closed\">Closed</option>\n                </select>\n            </div>\n            <div class=\"col-md-4 col-12\">\n                <input type=\"text\" id=\"searchInput\" class=\"form-control\" placeholder=\"Search by Student or Ticket ID\" aria-label=\"Search tickets\" />\n            </div>\n            <div class=\"col-md-2 col-12\">\n                <button class=\"btn btn-success w-100\" onclick=\"resetFilters()\" aria-label=\"Reset filters\">\n                    <i class=\"bi bi-arrow-repeat me-1\"></i> Reset Filters\n                </button>\n            </div>\n        </div>\n\n        <div class=\"table-responsive shadow-sm rounded\">\n            <table class=\"table table-striped table-hover align-middle\" id=\"ticketsTable\">\n                <thead class=\"table-success\">\n                    <tr>\n                        <th scope=\"col\">Ticket ID</th>\n                        <th scope=\"col\">Student Name</th>\n                        <th scope=\"col\">Category</th>\n                        <th scope=\"col\">Priority</th>\n                        <th scope=\"col\">Status</th>\n                        <th scope=\"col\">Date Submitted</th>\n                        <th scope=\"col\">Action</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php foreach ($tickets as $ticket): \n                        $ticketID = htmlspecialchars($ticket['ticket_id']);\n                        $studentName = htmlspecialchars($ticket['student_name']);\n                        $category = htmlspecialchars($ticket['category']);\n                        $priority = htmlspecialchars($ticket['priority']);\n                        $status = htmlspecialchars($ticket['status']);\n                        $dateSubmitted = date('Y-m-d h:i A', strtotime($ticket['date_submitted']));\n                        $message = htmlspecialchars($ticket['message']);\n\n                        // Priority badge class\n                        switch ($priority) {\n                            case 'High': $priorityClass = 'bg-danger'; break;\n                            case 'Medium': $priorityClass = 'bg-warning text-dark'; break;\n                            default: $priorityClass = 'bg-secondary'; break;\n                        }\n                        \n                        // Status badge class\n                        switch (strtolower($status)) {\n                            case 'open': $statusClass = 'badge-open'; break;\n                            case 'in progress': $statusClass = 'badge-inprogress'; break;\n                            case 'resolved': $statusClass = 'badge-resolved'; break;\n                            case 'closed': $statusClass = 'badge-closed'; break;\n                            default: $statusClass = ''; break;\n                        }\n\n                        // Prepare conversation HTML\n                        $convHTML = '';\n                        if (isset($conversations[$ticket['ticket_id']])) {\n                            foreach ($conversations[$ticket['ticket_id']] as $msg) {\n                                $convHTML .= '<p><strong>' . htmlspecialchars($msg['sender']) . ':</strong> ' . nl2br(htmlspecialchars($msg['message'])) . '</p>';\n                            }\n                        }\n                    ?>\n                    <tr>\n                        <td><?= $ticketID ?></td>\n                        <td><?= $studentName ?></td>\n                        <td><?= $category ?></td>\n                        <td><span class=\"badge <?= $priorityClass ?>\"><?= $priority ?></span></td>\n                        <td><span class=\"badge <?= $statusClass ?>\"><?= $status ?></span></td>\n                        <td><?= $dateSubmitted ?></td>\n                        <td>\n                            <button class=\"btn btn-sm btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#ticketModal\"\n                                onclick='openTicketDetails(\"<?= $ticketID ?>\", \"<?= addslashes($studentName) ?>\", \"<?= addslashes($category) ?>\", \"<?= addslashes($priority) ?>\", \"<?= addslashes($priorityClass) ?>\", \"<?= addslashes($status) ?>\", \"<?= addslashes($statusClass) ?>\", \"<?= addslashes($dateSubmitted) ?>\", \"<?= addslashes($message) ?>\", `<?= isset($convHTML) ? addslashes($convHTML) : '' ?>\")' \n                                aria-label=\"View details of ticket <?= $ticketID ?>\">\n                                <i class=\"bi bi-eye me-1\"></i> View\n                            </button>\n                        </td>\n                    </tr>\n                    <?php endforeach; ?>\n                </tbody>\n            </table>\n        </div>\n    </div>\n\n    <div class=\"modal fade\" id=\"ticketModal\" tabindex=\"-1\" aria-labelledby=\"ticketModalLabel\" aria-hidden=\"true\">\n        <div class=\"modal-dialog modal-lg modal-dialog-scrollable\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header bg-success text-white\">\n"
        }
    ]
}