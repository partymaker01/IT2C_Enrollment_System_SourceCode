{
    "sourceFile": "ADMIN/Enrollment_Management/view-pending-enrollment.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1748642498789,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1748642498789,
            "name": "Commit-0",
            "content": "<?php\r\n// Database config (edit to your own)\r\n$host = 'localhost';\r\n$db   = 'enrollment_system';\r\n$user = 'root';\r\n$pass = '';\r\n$charset = 'utf8mb4';\r\n\r\n// Create connection with PDO (better security and flexibility)\r\n$dsn = \"mysql:host=$host;dbname=$db;charset=$charset\";\r\n$options = [\r\n    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\r\n    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,\r\n];\r\n\r\ntry {\r\n    $pdo = new PDO($dsn, $user, $pass, $options);\r\n} catch (PDOException $e) {\r\n    exit('Database connection failed: ' . $e->getMessage());\r\n}\r\n\r\n// Fetch pending enrollments from DB\r\n$stmt = $pdo->query(\"SELECT * FROM pending_enrollments ORDER BY date_submitted DESC\");\r\n$pendingEnrollments = $stmt->fetchAll();\r\n\r\n?>\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\" />\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n  <title>Pending Enrollment Requests</title>\r\n  <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n  <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js\"></script>\r\n  <link rel=\"icon\" href=\"favicon.ico\" type=\"image/x-icon\">\r\n  <style>\r\n    /* Keep your existing styles here */\r\n    /* ... */\r\n  </style>\r\n</head>\r\n<body>\r\n<nav class=\"navbar navbar-expand-lg navbar-dark bg-success py-3\">\r\n  <div class=\"container-fluid\">\r\n    <a class=\"navbar-brand d-flex align-items-center\" href=\"#\">\r\n      <img src=\"/IT2C_Enrollment_System_SourceCode/picture/tlgc_pic.jpg\" alt=\"School Logo\" class=\"school-logo\">\r\n      Admin Panel\r\n    </a>\r\n    <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarNav\" aria-controls=\"navbarNav\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\r\n      <span class=\"navbar-toggler-icon\"></span>\r\n    </button>\r\n    <div class=\"collapse navbar-collapse\" id=\"navbarNav\">\r\n      <ul class=\"navbar-nav ms-auto\">\r\n        <li class=\"nav-item\"><a class=\"nav-link\" href=\"/IT2C_Enrollment_System_SourceCode/ADMIN/admin-dashboard.php\">\r\n          <i class=\"bi bi-arrow-left\"></i> Back to Dashboard\r\n        </a></li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</nav> \r\n\r\n<div class=\"container\">\r\n  <h2 class=\"mb-4 text-center\">\r\n    Pending Enrollment Requests\r\n  </h2>\r\n\r\n  <div class=\"table-responsive shadow-sm rounded bg-white\">\r\n    <table class=\"table table-bordered table-hover mb-0\">\r\n      <thead class=\"table-success\">\r\n        <tr>\r\n          <th>#</th>\r\n          <th>Student Name</th>\r\n          <th>Year Level</th>\r\n          <th>Program</th>\r\n          <th>Submitted On</th>\r\n          <th>Actions</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <?php if (empty($pendingEnrollments)): ?>\r\n          <tr><td colspan=\"6\" class=\"text-center\">No pending enrollments found.</td></tr>\r\n        <?php else: ?>\r\n          <?php foreach ($pendingEnrollments as $enrollment): ?>\r\n          <tr>\r\n            <td><?= htmlspecialchars($enrollment['id']) ?></td>\r\n            <td><?= htmlspecialchars($enrollment['name']) ?></td>\r\n            <td><?= htmlspecialchars($enrollment['year']) ?></td>\r\n            <td><?= htmlspecialchars($enrollment['program']) ?></td>\r\n            <td><?= date('M d, Y', strtotime($enrollment['date_submitted'])) ?></td>\r\n            <td class=\"d-flex flex-wrap gap-2 justify-content-center\">\r\n              <button class=\"btn btn-success btn-sm btn-action\"\r\n                data-action=\"approve\"\r\n                data-id=\"<?= $enrollment['id'] ?>\"\r\n                data-name=\"<?= htmlspecialchars($enrollment['name']) ?>\"\r\n                data-program=\"<?= htmlspecialchars($enrollment['program']) ?>\"\r\n                data-year=\"<?= htmlspecialchars($enrollment['year']) ?>\"\r\n                data-date=\"<?= date('M d, Y', strtotime($enrollment['date_submitted'])) ?>\"\r\n              >‚úÖ Approve</button>\r\n\r\n              <button class=\"btn btn-orange btn-sm btn-action\"\r\n                data-action=\"missing\"\r\n                data-id=\"<?= $enrollment['id'] ?>\"\r\n                data-name=\"<?= htmlspecialchars($enrollment['name']) ?>\"\r\n                data-program=\"<?= htmlspecialchars($enrollment['program']) ?>\"\r\n                data-year=\"<?= htmlspecialchars($enrollment['year']) ?>\"\r\n                data-date=\"<?= date('M d, Y', strtotime($enrollment['date_submitted'])) ?>\"\r\n              >‚ö†Ô∏è Missing</button>\r\n\r\n              <button class=\"btn btn-danger btn-sm btn-action\"\r\n                data-action=\"reject\"\r\n                data-id=\"<?= $enrollment['id'] ?>\"\r\n                data-name=\"<?= htmlspecialchars($enrollment['name']) ?>\"\r\n                data-program=\"<?= htmlspecialchars($enrollment['program']) ?>\"\r\n                data-year=\"<?= htmlspecialchars($enrollment['year']) ?>\"\r\n                data-date=\"<?= date('M d, Y', strtotime($enrollment['date_submitted'])) ?>\"\r\n              >‚ùå Reject</button>\r\n\r\n              <button class=\"btn btn-secondary btn-sm btn-action\"\r\n                data-action=\"view\"\r\n                data-id=\"<?= $enrollment['id'] ?>\"\r\n                data-name=\"<?= htmlspecialchars($enrollment['name']) ?>\"\r\n                data-program=\"<?= htmlspecialchars($enrollment['program']) ?>\"\r\n                data-year=\"<?= htmlspecialchars($enrollment['year']) ?>\"\r\n                data-date=\"<?= date('M d, Y', strtotime($enrollment['date_submitted'])) ?>\"\r\n              >üëÅÔ∏è View</button>\r\n            </td>\r\n          </tr>\r\n          <?php endforeach; ?>\r\n        <?php endif; ?>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n\r\n  <p class=\"text-muted mt-3 text-center\" style=\"font-size: 0.9rem;\">\r\n    Note: Approve or reject each request, or view full details before deciding.\r\n  </p>\r\n</div>\r\n\r\n<!-- Modal (same as your original modal) -->\r\n<div class=\"modal fade\" id=\"actionModal\" tabindex=\"-1\" aria-labelledby=\"actionModalLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header bg-success text-white\">\r\n        <h5 class=\"modal-title\" id=\"actionModalLabel\">Action Confirmation</h5>\r\n        <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <p id=\"modalMessage\">Are you sure?</p>\r\n        <p><strong>Name:</strong> <span id=\"studentName\"></span></p>\r\n        <p><strong>Program:</strong> <span id=\"studentProgram\"></span></p>\r\n        <p><strong>Year:</strong> <span id=\"studentYear\"></span></p>\r\n        <p><strong>Date:</strong> <span id=\"studentDate\"></span></p>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\r\n        <button type=\"button\" id=\"confirmActionBtn\" class=\"btn btn-primary\">Confirm</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<script>\r\n  const actionModal = new bootstrap.Modal(document.getElementById('actionModal'));\r\n\r\n  document.querySelectorAll('.btn-action').forEach(button => {\r\n    button.addEventListener('click', function () {\r\n      const action = this.getAttribute('data-action');\r\n      const name = this.getAttribute('data-name');\r\n      const program = this.getAttribute('data-program');\r\n      const year = this.getAttribute('data-year');\r\n      const date = this.getAttribute('data-date');\r\n      const id = this.getAttribute('data-id');\r\n\r\n      document.getElementById('studentName').textContent = name;\r\n      document.getElementById('studentProgram').textContent = program;\r\n      document.getElementById('studentYear').textContent = year;\r\n      document.getElementById('studentDate').textContent = date;\r\n\r\n      const modalMsg = {\r\n        'approve': 'Do you want to approve this enrollment?',\r\n        'missing': 'Mark this enrollment as missing documents?',\r\n        'reject': 'Are you sure you want to reject this enrollment?',\r\n        'view': 'Viewing full details below:'\r\n      };\r\n\r\n      document.getElementById('modalMessage').textContent = modalMsg[action] || 'Proceed with this action?';\r\n\r\n      const confirmBtn = document.getElementById('confirmActionBtn');\r\n      confirmBtn.textContent = action === 'view' ? 'Close' : 'Confirm';\r\n      confirmBtn.className = `btn ${action === 'approve' ? 'btn-success' : action === 'missing' ? 'btn-warning' : action === 'reject' ? 'btn-danger' : 'btn-secondary'}`;\r\n      \r\n      confirmBtn.onclick = () => {\r\n        if(action === 'view') {\r\n          actionModal.hide();\r\n          return;\r\n        }\r\n        \r\n        // You can replace this with AJAX to update DB accordingly\r\n        alert(`${action.charAt(0).toUpperCase() + action.slice(1)} confirmed for ${name} (ID: ${id}).`);\r\n        actionModal.hide();\r\n\r\n        // Optionally, refresh the page or remove the row from table dynamically\r\n      };\r\n\r\n      actionModal.show();\r\n    });\r\n  });\r\n</script>\r\n</body>\r\n</html>\r\n"
        }
    ]
}